extends base

block title
    title= config.title

block content
    .l-postlist
        each post in page.posts.toArray()
            .l-post
                include _partial/common.pug
                .p-desc.box
                    .p-pic
                    //- title
                    h1.p-title
                        a(href=url_for(post.path))
                            +title(post)

                    //- description
                    if post.description
                        .p-content
                            != post.description
                    else if post.excerpt
                        .p-content
                            != post.excerpt
                    else if post.content
                        - var br = 0
                        - for (var i = 0; i < 5; ++i) {
                            - br = post.content.indexOf('\n',br+1)
                            if br < 0
                                - break
                            if br > 150
                                - break
                        - }
                        if br < 0
                            .p-content
                                != post.content
                        else
                            .p-content
                                != post.content.substring(0, br)
                    //- readmore
                    p(class='p-readmore')
                        a(href=url_for(post.path))= __('阅读更多 >>')

                .p-info.box
                    span.p-meta
                        i(class='fa font-awesome '+ theme.icons.date)
                        a(href=url_for(post.path))= post.date.format(config.date_format)

                    - var numOfCategories = post.categories.length
                    if numOfCategories
                        span.p-category
                            i(class='fa font-awesome '+ theme.icons.category)
                            each category, index in post.categories.toArray()
                                a(href=url_for(category.path))= category.name
                                if index < numOfCategories - 1
                                    | &nbsp;&bull;&nbsp;
                                
                    if post.tags.length
                        span.p-tags
                            if post.tags.length == 1
                                i(class='fa font-awesome '+ theme.icons.tag)
                            else
                                i(class='fa font-awesome '+ theme.icons.tags)

                            each tag in post.tags.toArray()
                                a(href=url_for(tag.path))= tag.name

    include _partial/paginator.pug
